language: generic
os: osx
osx_image: xcode7.3
env:
  matrix:
  - CONDA_NPY=110  CONDA_PY=27
  - CONDA_NPY=111  CONDA_PY=27
  - CONDA_NPY=110  CONDA_PY=35
  - CONDA_NPY=111  CONDA_PY=35
  - CONDA_NPY=110  CONDA_PY=36
  - CONDA_NPY=111  CONDA_PY=36
  global:
  - secure: I1TaOdykMTeTNOE1wXVheiMqcMpealo7VQ+o7Vc3xAiJs2wuDyUfEZ91nk02S99Y68mBIY1XkYJx5WyyV8k7nTmgH1r1Vs/z97LXYfoZvCuwC6Ht9EiPes+b7huhtkPdkoZ3tbshnzJyxQlOy8k60URTq1Aexj2j4JLiDWwInCK6Zv0eqlnqTtCtsdiMCS4JDD9sU116EvKiGVdxQciLL9LgrPn3RVqt+arEad8GJNlvN25Kvr+r6ApT9VapIEummJCS6rUqdnM6DJr4UeRLseGtv8Mv4VaoLZJAFhKJPpXpoQJoGNr6BTRajDaZNeR2oarEray5rFzMkxmtC2I9oqZKqRrpwzagSjYpApqcUygD4rwgDyag2pottJffL3PVelaoED1fR9q6bG9m7saTSFvqEnuGlJtZyfAellDaMrwoi6nWrftde1dbjFo77jScIDM7wHqz+vH/sSdf5Cb0CBFh8FFG6bUwEmErFUSSx9DnVaebCobf/HjvO8QF/V2vaEVgkMVFwnXkvhJnpEGUgG0BtzfdIltvnW/GgNCTNr/YlpDYxo+dn45XAMrs/+MyiwM0wciHXuIJGKv6bcfYqboUXgvkmeEgKt5qGHjeXWTZqh+pZgR7ZFjMyOtd7tmr87hTzyZ8z/w8Hxw0mA2wJplWSvEuiw9Vu4fbQcrZ3Z4=
before_install:
- brew remove --force $(brew list)
- brew cleanup -s
- rm -rf $(brew --cache)
install:
- |
  MINICONDA_URL="https://repo.continuum.io/miniconda"
  MINICONDA_FILE="Miniconda3-latest-MacOSX-x86_64.sh"
  curl -L -O "${MINICONDA_URL}/${MINICONDA_FILE}"
  bash $MINICONDA_FILE -b

  source /Users/travis/miniconda3/bin/activate root
  conda config --add channels conda-forge
  conda config --set show_channel_urls true
  conda config --set anaconda_upload yes
  conda install --yes --quiet conda-forge-build-setup
  conda config --set anaconda_upload yes
  anaconda config --set token "${BINSTAR_TOKEN}"
  export CONDA_DIR=$(python -c 'import sys; print(sys.executable.split("/bin/python")[0])')
  conda create -y -n py27 python=2.7 mercurial
  ln -s ${CONDA_DIR}/envs/py27/bin/hg ${CONDA_DIR}/bin
  source run_conda_forge_build_setup
script:
- conda build ./recipe
